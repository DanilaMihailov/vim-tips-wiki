*vim-wiki-tips-874.txt*   Fold C-style comments *vwt-874*





This tip is very similar to the following:
    - VimTip108 |vwt-108|


These tips need to be merged – see the merge guidelines 
[https://vim.fandom.com/wiki/Vim_Tips_Wiki:Merge_guidelines].Tip 874 [https://vim.fandom.com/wiki/Fold_C-style_comments]   Previous |vwt-873| Next |vwt-875|

created February 11, 2005 · complexity intermediate · author David Vos · 
version 6.0

==============================================================================

This page is dodgy [https://vim.fandom.com/wiki/Category:Dodgy]. The contents 
may not be useful for Vim 7. If you think this tip is useful, please edit it 
to make the problem and its solution more understandable, and remove the 
{{Dodgy}} tag.

Comment syntax folding is included by default in the c.vim syntax file, but 
the custom foldtext function may still be useful

Do you want to make a 10-line /*C-style*/ comment disappear?

You can add folding capability to C-style comments using the command:

>
    au BufNewFile,BufRead *.cpp,*.c,*.h,*.java syn region myCComment start="/\*" end="\*/" fold keepend transparent
<

This will work on C, .h, C++, and Java files.

The "keepend" and "transparent" commands are necessary to avoid overriding 
the default syntax highlighting of comments.

If you want to keep the "/*" beginning of the comment in the folded text, you 
can use the following function:

>
    set foldtext=MyFoldText()
    function MyFoldText()
      let line = getline(v:foldstart)
      let sub = substitute(line, '^[\t ]*', '', '')
      let nlines = v:foldend - v:foldstart + 1
      if strlen(nlines) == 1
        let nlines = " " . nlines
      elseif strlen(nlines) == 2
        let nlines = " " . nlines
      endif
      return "+-" . v:folddashes . nlines . ": " . sub
    endfunction
<

The resulting line should look about the same as the default, without 
removing the comments.

COMMENTS  *vwt-874-comments*