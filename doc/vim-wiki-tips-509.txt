*vim-wiki-tips-509.txt*   Execute commands without changing the search register *vwt-509*



Please review this tip:
    - This tip was imported from vim.org and needs general review [https://vim.fandom.com/wiki/Vim_Tips_Wiki:General_guidelines].
    - You might clean up comments [https://vim.fandom.com/wiki/Vim_Tips_Wiki:Comment_guidelines] or merge similar tips [https://vim.fandom.com/wiki/Vim_Tips_Wiki:Merge_guidelines].
    - Add suitable categories [https://vim.fandom.com/wiki/Vim_Tips_Wiki:Category_guidelines] so people can find the tip.
    - Please avoid the discussion page [https://vim.fandom.com/wiki/Vim_Tips_Wiki:Discussion_guidelines] (use the Comments section below for notes).
    - If the tip contains good advice for current Vim, remove the {{review}} line.
Tip 509 [https://vim.fandom.com/wiki/Execute_commands_without_changing_the_search_register]   Previous |vwt-507| Next |vwt-510|

created July 15, 2003 · complexity intermediate · author Salman Halim · 
version 6.0

==============================================================================

I frequently execute commands (mappings, usually) that perform operations 
that change the value of the search register for the sake of the mapping. They 
might do a :s or some such that affects the search register. I don't always 
want this side effect, so I use the following command/function:

>
    " Executes a command (across a given range) and restores the search register
    " when done.
    function! SafeSearchCommand(line1, line2, theCommand)
      let search = @/
      execute a:line1 . "," . a:line2 . a:theCommand
      let @/ = search
    endfunction
    com! -range -nargs=+ SS call SafeSearchCommand(<line1>, <line2>, <q-args>)
    " A nicer version of :s that doesn't clobber the search register
    com! -range -nargs=* S call SafeSearchCommand(<line1>, <line2>, 's' . <q-args>)
<

Basically, :SS followed by any command will execute that command (to simulate 
keystrokes, use :normal as the command) and restore the search register when 
it's done. :S is a replacement for :s which works EXACTLY the same way (with 
or without range, flags etc) but doesn't clobber the search register in the 
process.

COMMENTS  *vwt-509-comments*